<!--
/**
* Copyright 2016 - 29cu.io and the authors of beta-ori open source project

* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at

*     http://www.apache.org/licenses/LICENSE-2.0

* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
**/
-->

<header>
	<div class="container-fluid">
		<h1>Create New Application</h1>
	</div>
</header>
<section>
	<form id="login-form" #f="ngForm" style="display: block;" (ngSubmit)="onSubmitCreateApplication('create')">
		<div class="container-fluid">
			<div id="accordion" role="tablist" aria-multiselectable="true">
				<div class="card">
					<div class="card-header" role="tab" id="headingOne">
						<h4 class="mb-0">
							<a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">General</a>
						</h4>
					</div>
					<div id="collapseOne" class="collapse in" role="tabpanel" aria-labelledby="headingOne">
						<div class="card-block">
							<div class="form-group row">
								<label for="example-text-input" class="col-xs-2 col-form-label">Name</label>
								<div class="col-xs-5">
									<input type="text" #name tabindex="1" class="form-control" id="name" name="name" placeholder="" [(ngModel)]="newApplication.name"
										required (change)="onChangeAppName()">
										<label class="redlabel" *ngIf="!nameIsUnique">Duplicate name</label>
								</div>
							</div>
							<div class="form-group row">
								<label for="example-text-input" class="col-xs-2 col-form-label">Description</label>
								<div class="col-xs-5">
									<input type="text" #description tabindex="1" class="form-control" id="description" name="description" placeholder="" [(ngModel)]="newApplication.description"
										required>
								</div>
							</div>
							<div class="form-group row">
								<label for="example-text-input" class="col-xs-2 col-form-label">Version</label>
								<div class="col-xs-5">
									<input type="text" #version tabindex="1" class="form-control" id="version" name="version" placeholder="" [(ngModel)]="newApplication.version"
										required minlength="1" pattern="((\d{1,3})|(\d{1,3}.\d{1,4})|(\d{1,3}.\d{1,4}.\d{1,4}))">
								</div>
							</div>
							<div class="form-group row">
								<label for="example-text-input" class="col-xs-2 col-form-label">Category</label>
								<div class="col-xs-5">
									<select #category tabindex="1" class="form-control" id="category" name="category" placeholder="" [(ngModel)]="newApplication.category"
										required>
										<option *ngFor="let code of categoryArray" [ngValue]="code.name">{{code.value}}</option>
									</select>
								</div>
							</div>
							<div class="form-group row">
								<label for="example-text-input" class="col-xs-2 col-form-label">What's New</label>
								<div class="col-xs-5">
									<input type="text" #whatsnew tabindex="1" class="form-control" id="whatsnew" name="whatsnew" placeholder="" [(ngModel)]="newApplication.whatsNew">
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="card">
					<div class="card-header" role="tab" id="headingTwo">
						<h4 class="mb-0">
							<a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">More...</a>
						</h4>
					</div>
					<div id="collapseTwo" class="collapse" role="tabpanel" aria-labelledby="headingTwo">
						<div class="card-block">
							<div class="container">
								<div class="row">
									<div class="col-md-12">
										<div class="panel panel-default">
											<div class="panel-body">
												<form ng-submit="addNew()">
													<table class="table table-striped table-bordered">
														<thead>
															<tr>
																<th><input type="checkbox" [(ngModel)]="selectedAll" (click)="checkAll()" [ngModelOptions]="{standalone: true}" checked=[selectedAll]/></th>
																<th>Platform</th>
																<th>OS</th>
																<th>Download Url</th>
																<th>Express Install Command</th>
															</tr>
														</thead>
														<tbody>
															<tr *ngFor="let installer of newApplication.installers">
																<td>
																	<input #installer.selected tabindex="1" type="checkbox" name="selected" placeholder="" [(ngModel)]="installer.selected" value=[installer.selected] (click)="installer.selected=!installer.selected;" /></td>
																<td>
																	<select #installer.platform tabindex="1" class="form-control" id="installer.platform" name="platform" placeholder="" [(ngModel)]="installer.platform" required>
																		<option value="">--Select--</option>
																		<option value="x64">x64</option>
																		<option value="x86">x86</option>
																	</select>
																</td>
																<td>
																	<select #installer.os tabindex="1" class="form-control" id="installer.os" name="os" placeholder="" [(ngModel)]="installer.os" required>
																		<option value="">--Select--</option>
																		<option value="Windows">Windows</option>
																		<option value="Mac">Mac</option>
																		<option value="Linux">Linux</option>
																	</select>
																</td>
																<td>
																	<input type="text" #downloadUrl tabindex="1" class="form-control" id="installer.downloadUrl" name="installer.downloadUrl" placeholder="" [(ngModel)]="installer.downloadUrl" required>
																<td>
																	<input type="text" #expressInstallCommand tabindex="1" class="form-control" id="installer.expressInstallCommand" name="installer.expressInstallCommand" placeholder="" [(ngModel)]="installer.expressInstallCommand" /></td>
															</tr>
														</tbody>
													</table>

													<div class="form-group row">&nbsp;&nbsp;&nbsp;&nbsp;
														<div class="col-sm-1 col-sm-offset">
															<button [disabled]="newApplication.installers.length>4" type="submit" name="add-installer" id="add-installer"  class="btn btn-primary addnew pull-right" (click)="onSubmitInstaller('add'); $event.preventDefault()">
																Add New
															</button>
														</div>
														<div class="col-sm-1 col-sm-offset">
															<button [disabled]="newApplication.installers.length<2" type="submit" name="remove-installer" id="remove-installer" class="btn btn-danger remove pull-right" (click)="onSubmitInstaller('remove'); $event.preventDefault()">
																Remove
															</button>
														</div>
													</div>
												</form>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<br/><br/>
			<div class="form-group row">
				<label for="example-text-input" class="col-xs-2 col-form-label"></label>
				<div class="col-sm-2 col-sm-offset-1">
					<button type="submit" name="dev-app-create" id="dev-app-create" tabindex="4" class="form-control btn btn-success" [disabled]="!f.valid"
					(click)="onSubmitCreateApplication('create'); $event.preventDefault()">Save</button>	
				</div>
				<div class="col-sm-2 col-sm-offset-1">
					<button type="submit" name="dev-app-close" id="dev-app-close" tabindex="5" class="form-control btn btn-success" 
					(click)="onSubmitCreateApplication('close'); $event.preventDefault()">Close</button>	
				</div>
				<!--div class="col-sm-2 col-sm-offset-1">
					<button type="submit" name="dev-app-publish" id="dev-app-publish" tabindex="5" class="form-control btn btn-success" [disabled]="!f.valid"
						(click)="onSubmitCreateApplication('publish'); $event.preventDefault()">Publish</button>
				</div-->
			</div>
		</div>
	</form>
</section>
